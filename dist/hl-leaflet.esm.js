import e from"leaflet";function n(){return n=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},n.apply(this,arguments)}var t={};function o(e){return Array.prototype.slice.call(e)}function r(){return o(document.body.querySelectorAll(".hl-map")).map(function(e){var n,t,r,a=e.dataset,i={hlRender:null!=(n=a.hlRender)?n:"",hlCenter:null!=(t=a.hlCenter)?t:"[0,0]",hlZoom:null!=(r=a.hlZoom)?r:"10",markers:[]};return o(e.querySelectorAll(".hl-marker")).forEach(function(e){var n=e.dataset;i.markers.push({hlCenter:n.hlCenter,hlPopup:n.hlPopup})}),{config:i,configElement:e,renderElement:document.querySelector(i.hlRender)}})}function a(n){var t,o=n.map;if(void 0!==o){var r=n.config.hlZoom;o.setView(JSON.parse(n.config.hlCenter),parseInt(r)),(null==(t=o.options.layers)?void 0:t.find(function(e){return"© OpenStreetMap contributors"===e.options.attribution}))||e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(o),o.eachLayer(function(n){n instanceof e.Marker&&n.removeFrom(o)}),n.config.markers.forEach(function(t){var r,a,i=null!=(r=t.hlCenter)?r:n.config.hlCenter,l=null!=(a=t.hlPopup)?a:"",c=e.marker(JSON.parse(i));c.setIcon(e.icon({iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]})),""!==l&&c.bindPopup(l),c.addTo(o)})}}function i(o){o.forEach(function(o){var r=o.configElement,i=o.renderElement,l=o.config;if(null!==i){var c=e.map(i);o.map=c,a(o),t[r.id]=n({},o,{configString:JSON.stringify(l)}),c.on("moveend",function(){var e=c.getCenter(),n=c.getZoom(),t=new CustomEvent("hl-leaflet-moveend",{detail:{center:[e.lat,e.lng],zoom:n}});i.dispatchEvent(t)}),c.on("popupopen",function(e){var n=new CustomEvent("hl-leaflet-popupopen",{detail:{popup:e.popup.getElement()}});i.dispatchEvent(n)})}})}function l(e){e.forEach(function(e){var n=t[e.configElement.id];if(void 0!==n&&void 0!==n.map){var o=JSON.stringify(e.config);o!=n.configString&&(n.config=e.config,n.configString=o,a(n))}})}window.addEventListener("load",function(){i(r()),new MutationObserver(function(){return l(r())}).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-hl-center","data-hl-zoom","data-hl-render","data-hl-popup"]})});var c={findMaps:r,initMaps:i,updateMaps:l,mapCache:t,apply:a};export{c as default};
//# sourceMappingURL=hl-leaflet.esm.js.map
