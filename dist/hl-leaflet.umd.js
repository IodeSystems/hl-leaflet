!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],t):(e||self).hlLeaflet=t(e.leaflet)}(this,function(e){function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=/*#__PURE__*/t(e);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}var r={};function i(e){var t=e.getCenter(),n=e.getZoom(),o=e.getBounds().getNorthWest(),r=e.getBounds().getSouthEast();return new CustomEvent("hl-leaflet-moveend",{detail:{center:[t.lat,t.lng],zoom:n,bounds:[[o.lat,o.lng],[r.lat,r.lng]]}})}function a(e){return Array.prototype.slice.call(e)}function l(){return a(document.body.querySelectorAll(".hl-map")).map(function(e){var t,n,o,r,i=e.dataset,l={hlRender:null!=(t=i.hlRender)?t:"",hlCenter:JSON.parse(null!=(n=i.hlCenter)?n:"[0,0]"),hlZoom:JSON.parse(null!=(o=i.hlZoom)?o:"10"),hlPreserve:JSON.parse(null!=(r=i.hlPreserve)?r:"false"),markers:[]};return a(e.querySelectorAll(".hl-marker")).forEach(function(e){var t,n=e.dataset;l.markers.push({hlCenter:JSON.parse(null!=(t=n.hlCenter)?t:"[0,0]"),hlPopup:n.hlPopup})}),{config:l,configElement:e,renderElement:document.querySelector(l.hlRender)}})}function u(e){var t,o=e.map;void 0!==o&&(o.setView(e.config.hlCenter,e.config.hlZoom),(null==(t=o.options.layers)?void 0:t.find(function(e){return"© OpenStreetMap contributors"===e.options.attribution}))||n.default.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(o),o.eachLayer(function(e){e instanceof n.default.Marker&&e.removeFrom(o)}),e.config.markers.forEach(function(t){var r,i,a=null!=(r=t.hlCenter)?r:e.config.hlCenter,l=null!=(i=t.hlPopup)?i:"",u=n.default.marker(a);u.setIcon(n.default.icon({iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]})),""!==l&&u.bindPopup(l),u.addTo(o)}))}function c(e){e.forEach(function(e){var t=e.configElement,a=e.renderElement,l=e.config;if(null!==a){var c=n.default.map(a);e.map=c,u(e),r[t.id]=o({},e,{configString:JSON.stringify(l)}),c.on("moveend",function(){a.dispatchEvent(i(c))}),c.on("popupopen",function(e){var t={popup:e.popup.getElement()},n=new CustomEvent("hl-leaflet-popupopen",{detail:t});a.dispatchEvent(n)}),a.dispatchEvent(i(c))}})}function f(e){e.forEach(function(e){var t=r[e.configElement.id];if(void 0!==t&&void 0!==t.map){var n=JSON.stringify(e.config);n!=t.configString&&(t.config=e.config,t.configString=n,u(t))}})}return window.addEventListener("load",function(){c(l()),new MutationObserver(function(){return f(l())}).observe(document.body,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["data-hl-center","data-hl-zoom","data-hl-render","data-hl-popup"]})}),{findMaps:l,initMaps:c,updateMaps:f,mapCache:r,apply:u,syncMove:function(e,t){e.setAttribute("data-hl-center",JSON.stringify(t.center)),e.setAttribute("data-hl-zoom",JSON.stringify(t.zoom)),e.setAttribute("data-hl-bounds",JSON.stringify(t.bounds));var n=r[e.id];void 0!==n&&(n.config=o({},n.config,{hlCenter:t.center,hlZoom:t.zoom}),n.configString=JSON.stringify(n.config))}}});
//# sourceMappingURL=hl-leaflet.umd.js.map
